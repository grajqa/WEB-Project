//resxclsx.js v5.12 Copyright 2004-2023 Certona Corporation www.certona.com. All rights reserved.
//www.sephora.com
var certonaResx=function(){"use strict";var a,o="certonaResx.showResponse",l="",u,d,x=false,p,h,g,m,y,v,k,R;function s(e){try{return parseInt(e,10)}catch(e){}}function w(e){try{var r;if(e!==undefined&&e!==null&&e!=="null"&&e!==""){r=true;return r}}catch(e){}return false}function f(){try{return resx.rrelem}catch(e){}return""}function c(e){try{var r=null,n,t;if(w(e)){r=[];if(w(document.getElementById(e))){r[0]=e}else{t=e.replace(/[,;]/g,".").split(".");for(n=0;n<t.length;n+=1){if(t[n]!==""&&w(document.getElementById(t[n]))){r[n]=t[n]}else{r[n]=""}}}}return r}catch(e){}return null}function b(){try{var e,r,n;if(resx.rrelem!==undefined){n=c(f());if(n!==undefined&&n!==null){for(e=0;e<n.length;e+=1){if(n[e]!==""){r=document.getElementById(n[e])}else{r=null}if(w(r)){r.style.visibility="visible"}}}}}catch(e){}}function C(e,r){try{if(!x){x=true;l=e+"|"+(r.number!==undefined?r.number:"undefined")+"|"+(r.name!==undefined?r.name:"undefined")+"|"+(r.description!==undefined?r.description:"undefined")}}catch(e){}finally{b()}}function I(e){try{var r,n,t;if(document.cookie.length>0){r=document.cookie;n=r.indexOf(e+"=");if(n!==-1){n+=e.length+1;t=r.indexOf(";",n);if(t===-1){t=r.length}return decodeURIComponent(r.slice(n,t))}}}catch(e){C("",e)}return null}function L(e,r,n,t){try{var i=new Date;if(n!==null){i.setTime(i.getTime()+n*3600*1e3)}document.cookie=e+"="+encodeURIComponent(r)+(n!==null?"; expires="+i.toGMTString():"")+"; path=/"+(w(t)?"; domain="+t:"")+"; secure"}catch(e){C("",e)}}function T(){try{var e,r,n,t,i;r=resx.rrec!==undefined&&(resx.rrec===true||resx.rrec==="true")&&(y==="1"||p)&&w(resx.rrelem)&&!x;if(r){if(!d){r=false;i=c(f());if(i!==undefined&&i!==null){for(e=0;e<i.length;e+=1){if(w(i[e])){r=true;break}}}}if(r){if(!w(resx.useitems)){r=false;if(resx.rrnum!==undefined){n=resx.rrnum;n+="";n=n.replace(/,/g,";");t=n.split(";");for(e=0;e<t.length;e+=1){if(!isNaN(t[e])&&s(t[e])>0){r=true;break}}}}}}return r}catch(e){}return false}function B(e){try{var r,n="";e+="";for(r=e.length-1;r>=0;r-=1){n+=e.charAt(r)}return n}catch(e){}return""}function E(){try{var e,r,n,t,i;if(navigator.userAgent.toLowerCase().indexOf("mac")===-1){i=Math.floor(Math.random()*1e15);i+=""}else{n=Math.floor(Math.random()*1e6);e=new Date;r=e.getTime();r+="";t=B(r);n+="";i=n+t.slice(0,11)}return i}catch(e){C("guid",e)}return""}function r(e){try{u=true;var r,n,t,i;if(!d){for(r=0;r<e.Resonance.Response.length;r+=1){n=false;t=e.Resonance.Response[r].scheme;if(e.Resonance.Response[r].display==="yes"){n=true;i=document.getElementById(t);if(w(i)){i.innerHTML=e.Resonance.Response[r].output}}if(typeof resonanceResponseLoaded==="function"){resonanceResponseLoaded(t,n)}}if(typeof resonanceResponseLoadedAll==="function"){resonanceResponseLoadedAll()}}}catch(e){}finally{b()}}function e(){try{if(!u&&!d){if(a<2e3){a=a+10;window.setTimeout(certonaResx.checkCallback,10)}else{d=true;b()}}}catch(e){b()}}function S(e){try{var r,n="",t="",i,s,c;s="";if(w(resx.rrelem)){i=f().replace(/[,;]/g,".").split(".");if(i!==null){for(r=0;r<i.length;r+=1){s+="&sc="+i[r]}}}if(typeof e==="boolean"&&e===true){if(w(resx.rrcall)){n=resx.rrcall}else{n=o}}else if(typeof e==="string"){n=e}if(n.length>0){if(n===o){t="&cb="}else{t="&ccb="}t+=n}c=s+(w(resx.useitems)?"&ui="+resx.useitems:"&no="+resx.rrnum)+(w(resx.rrqs)?"&"+resx.rrqs:"")+(w(resx.rrnav)?"&nav="+resx.rrnav:"")+(w(resx.exitemid)?"&ex="+resx.exitemid:"")+t;return c}catch(e){}return""}function U(){try{var e,r,n=window.location.hostname;if(w(n)){if(!n.match(/(\d{1,3}\.){3}\d{1,3}/)){e=n.split(".");if(e.length>1){n="."+e[e.length-2]+"."+e[e.length-1];r=/\.co\.\w{2}$|\.com\.\w{2}$|\.\w{2}\.com$/;if(n.toLowerCase().match(r)&&e.length>2){n="."+e[e.length-3]+n}}}return n}}catch(e){C("gsd",e)}return null}function M(){try{var e,r="",n;for(e=0;e<51;e+=1){if(resx["cv"+e]!==undefined){n=resx["cv"+e];n+="";n=n.replace(/\+/g,"%2B");r+="&cv"+e+"="+encodeURIComponent(n)}}return r}catch(e){C("gcv",e)}return""}function n(e){try{var r={callback:false},n,t,i,s,c,f;if(e===undefined){e=r}else{for(s=0;s<r.length;s+=1){if(e[s]===undefined){e[s]=r[s]}}}x=false;l="";v="";k=-1;R=false;y="";g="";m="";p=false;h=false;u=false;d=false;a=0;n=U();c="RES_TRACKINGID";f=false;if(w(resx.dnt)){if(resx.dnt===0){if(w(resx.trackingid)){v=String(resx.trackingid)}f=true;k=0}if(resx.dnt===1){if(w(resx.trackingid)){v=String(resx.trackingid)}else{v="000000000000000"}f=true;k=1}if(!w(v)){f=false;k=-1;R=true}}if(!f){if(w(resx.trackingid)){v=String(resx.trackingid)}else{v=I(c)}if(!w(v)){v=E()}}y=w(resx.segment)?String(resx.segment):"";if(!w(y)){y="1"}else{p=true}if(!R){if(!f){if(v.length>0){L(c,v,9490,n);if(!w(I(c))){L(c,v,null,n)}}}else{L(c,v,-1,n)}}if(w(resx.pageid)){g=resx.pageid}else{g=E()}t=resx.links!==undefined?String(resx.links):"";if(w(t)){i=t.replace(/\,/g,";").replace(/\|/g,"%7C").split(";",50);for(s=0;s<i.length;s+=1){m+=i[s]+";"}}if(typeof e.callback==="string"&&e.callback!==o||e.callback===false||w(resx.rrcall)&&resx.rrcall!==o){d=true}h=T()&&w(v)&&w(g);if(!h){b()}}catch(e){C("pv",e)}}function t(e){try{var r,n,t,i,s,c,f="5.12x";if((y==="1"||p)&&!R){if(h){window.setTimeout(certonaResx.checkCallback,50)}r=window.location.protocol.toLowerCase()==="https:"?"https://":"http://";i="www.res-x.com";if(w(resx.host)){i=resx.host}s=window.location.href.slice(0,400);if(w(resx.href)){s=resx.href}c=document.referrer;if(w(resx.referrer)){c=resx.referrer}n="appid="+(resx.appid!==undefined?resx.appid:"")+"&tk="+(w(v)?v:"")+"&pg="+(w(g)?g:"")+"&sg="+(w(y)?y:"");n+=(resx.event!==undefined?"&ev="+resx.event:"")+(resx.itemid!==undefined?"&ei="+resx.itemid:"")+(resx.qty!==undefined?"&qty="+resx.qty:"")+(resx.price!==undefined?"&pr="+resx.price:"")+(resx.shipping!==undefined?"&sh="+resx.shipping:"")+(resx.total!==undefined?"&tt="+resx.total:"")+(resx.currencycode!==undefined?"&cc="+resx.currencycode:"")+(w(resx.customerid)&&!(k===0||k===1)?"&cu="+resx.customerid:"")+(resx.transactionid!==undefined?"&tr="+resx.transactionid:"")+(resx.keyword!==undefined?"&kwd="+resx.keyword:"")+M()+(w(m)?"&plk="+m:"");n+=k===0||k===1?"&dnt="+k:"";n+="&bx="+h+(h?S(e):"");n+="&vr="+f+"&url="+encodeURIComponent(s)+"&ref="+encodeURIComponent(c)+(x===true?"&er="+x+"&em="+encodeURIComponent(l):"");t=r+i+"/ws/r2/Resonance.aspx"+"?"+n;return t.slice(0,2013)}}catch(e){}return""}function i(e){try{if(e!==""){var r=document.createElement("script"),n=document.getElementsByTagName("script")[0];r.type="text/javascript";r.async=true;r.src=e;n.parentNode.insertBefore(r,n)}}catch(e){}}function q(e){var r={callback:false},n;if(e===undefined){e=r}else{for(n=0;n<r.length;n+=1){if(e[n]===undefined){e[n]=r[n]}}}return t(e.callback)}function A(){n({callback:true});var e=t(true);i(e)}return{checkCallback:function(){e()},showResponse:function(e){r(e)},getURL:function(e){n(e);return q(e)},run:function(){A()}}}();
(function(m){"use strict";var h={desktop:{us:"sephora01",ca:"sephora02"},mobile:{us:"sephora03",ca:"sephora04"},default:{us:"sephora01",ca:"sephora02"}};var o={desktop:{us:{home:"home1_rr;home2_rr;home3_rr;home4_rr",product:"product1_rr;product2_rr;product4_rr",productsimilar:"product5_rr",productcleanhighlight:"product6_rr",pdp_segment:"product1_rr;product3_rr;product2_rr;product4_rr",category:"category1_rr;category2_rr;category3_rr;category4_rr;category5_rr",justarrivedgrid:"content1_rr",bestsellersgrid:"content2_rr",nosearch:"nosearch1_rr;nosearch2_rr",cart:"basket1_rr",ropiscart:"basket1_rr;basket3_rr;ropis2_rr",minicart:"basket2_rr",addtocart:"basket2_rr",ropisaddtocart:"ropis1_rr",purchase:"orderconfirm1_rr",beautyinsider:"beautyinsider_rr",profile:"profile_rr",similar:"content5_rr",fptab:"fptab_rr",loyalty:"loyalty_rr",promolanding:"promolanding_rr",purchasehistory:"purchasehistory1_rr",similarproductselected:"similarproductshover_rr",compareproductselected:"compareproductshover_rr",holidayhub:"holidayhub1_rr;holidayhub2_rr",atrisklapsed:"atrisklapsed1_rr;atrisklapsed2_rr;atrisklapsed3_rr",conveniencehub:"conveniencehub1_rr",mysephora:"mysephora1_rr",savingsevent:"holidaysavings1_rr;holidaysavings2_rr"},ca:{home:"home1_rr;home2_rr;home3_rr;home4_rr",product:"product1_rr;product2_rr;product4_rr",productsimilar:"product5_rr",productcleanhighlight:"product6_rr",pdp_segment:"product1_rr;product3_rr;product2_rr;product4_rr",category:"category1_rr;category2_rr;category3_rr;category4_rr;category5_rr",justarrivedgrid:"content1_rr",bestsellersgrid:"content2_rr",nosearch:"nosearch1_rr;nosearch2_rr",cart:"basket1_rr",ropiscart:"basket1_rr;basket3_rr;ropis2_rr",minicart:"basket2_rr",addtocart:"basket2_rr",ropisaddtocart:"ropis1_rr",purchase:"orderconfirm1_rr",beautyinsider:"beautyinsider_rr",profile:"profile_rr",similar:"content5_rr",fptab:"fptab_rr",loyalty:"loyalty_rr",promolanding:"promolanding_rr",purchasehistory:"purchasehistory1_rr",similarproductselected:"similarproductshover_rr",compareproductselected:"compareproductshover_rr",holidayhub:"holidayhub1_rr;holidayhub2_rr",atrisklapsed:"atrisklapsed1_rr;atrisklapsed2_rr;atrisklapsed3_rr",conveniencehub:"conveniencehub1_rr",mysephora:"mysephora1_rr",savingsevent:"holidaysavings1_rr;holidaysavings2_rr"}},mobile:{us:{home:"home1_rr;home2_rr;home3_rr;home4_rr",product:"product1_rr;product2_rr;product4_rr",productsimilar:"product5_rr",productcleanhighlight:"product6_rr",pdp_segment:"product1_rr;product3_rr;product2_rr;product4_rr",category:"category1_rr;category2_rr;category3_rr;category4_rr;category5_rr",justarrivedgrid:"content1_rr",bestsellersgrid:"content2_rr",nosearch:"nosearch1_rr;nosearch2_rr",cart:"basket1_rr",ropiscart:"basket1_rr;basket3_rr;ropis2_rr",minicart:"basket2_rr",addtocart:"basket2_rr",ropisaddtocart:"ropis1_rr",purchase:"orderconfirm1_rr",beautyinsider:"beautyinsider_rr",profile:"profile_rr",similar:"content5_rr",fptab:"fptab_rr",loyalty:"loyalty_rr",promolanding:"promolanding_rr",purchasehistory:"purchasehistory1_rr",similarproductselected:"similarproductshover_rr",compareproductselected:"compareproductshover_rr",holidayhub:"holidayhub1_rr;holidayhub2_rr",atrisklapsed:"atrisklapsed1_rr;atrisklapsed2_rr;atrisklapsed3_rr",conveniencehub:"conveniencehub1_rr",mysephora:"mysephora1_rr",savingsevent:"holidaysavings1_rr;holidaysavings2_rr"},ca:{home:"home1_rr;home2_rr;home3_rr;home4_rr",product:"product1_rr;product2_rr;product4_rr",productsimilar:"product5_rr",productcleanhighlight:"product6_rr",pdp_segment:"product1_rr;product3_rr;product2_rr;product4_rr",category:"category1_rr;category2_rr;category3_rr;category4_rr;category5_rr",justarrivedgrid:"content1_rr",bestsellersgrid:"content2_rr",nosearch:"nosearch1_rr;nosearch2_rr",cart:"basket1_rr",ropiscart:"basket1_rr;basket3_rr;ropis2_rr",minicart:"basket2_rr",addtocart:"basket2_rr",ropisaddtocart:"ropis1_rr",purchase:"orderconfirm1_rr",beautyinsider:"beautyinsider_rr",profile:"profile_rr",similar:"content5_rr",fptab:"fptab_rr",loyalty:"loyalty_rr",promolanding:"promolanding_rr",purchasehistory:"purchasehistory1_rr",similarproductselected:"similarproductshover_rr",compareproductselected:"compareproductshover_rr",holidayhub:"holidayhub1_rr;holidayhub2_rr",atrisklapsed:"atrisklapsed1_rr;atrisklapsed2_rr;atrisklapsed3_rr",conveniencehub:"conveniencehub1_rr",mysephora:"mysephora1_rr",savingsevent:"holidaysavings1_rr;holidaysavings2_rr"}}};var r=["mysephora"];window.callCertona=function(r){try{var e=r&&r.basketProducts&&r.basketProducts.map(function(r){return r+";SKU"+r});var t=h[v(b("device")||"default")][v(b("country"))];window.resx={appid:t,rrec:false,rrnum:20,itemid:"",event:"",rrelem:null,exitemid:e?e.join(";"):"",rrqs:"",rrnav:"",pageid:""};var a=r&&r.event?r.event:v(b("pagetype"));certona.filter={};certona.filter.language=b("language");switch(a){case"product":if(certona.pdp_segment){a="pdp_segment";certona.filter.pdp_segment=certona.pdp_segment}f({event:"product",itemid:b("itemid")});break;case"category":certona.filter.categoryid=certona.categoryid;break;case"justarrivedgrid":resx.pageid=certona.pageId||y();certona.filter.categoryid=certona.categoryid;certona.filter.page=certona.page||"1";break;case"bestsellersgrid":resx.rrnum=200;resx.pageid=certona.pageId||y();certona.filter.categoryid=certona.categoryid;certona.filter.page=certona.page||"1";break;case"cart":certona.filter.isflash=certona.isflash;certona.filter.freeshipping=certona.freeshipping;f({event:"viewcart",itemid:b("itemid")});resx.customerid=b("customerid");break;case"ropiscart":certona.filter.isflash=certona.isflash;certona.filter.freeshipping=certona.freeshipping;certona.filter.storeid=b("storeid");f({event:"viewcart",itemid:b("itemid")});resx.customerid=b("customerid");break;case"nosearch":certona.filter.searchTerm=certona.searchTerm;break;case"purchase":f({event:"purchase",itemid:b("itemid")});resx.customerid=b("customerid");resx.transactionid=b("transactionid");resx.qty=b("qty");resx.price=b("price");resx.total=b("total");break;case"account":resx.customerid=b("customerid");break;case"wishlist":f({event:"wishlist",itemid:b("itemid")});resx.customerid=b("customerid");break;case"conveniencehub":certona.filter.storeid=b("storeid");break;case"mysephora":var o=b("language"),i=b("storeid"),c=b("SkinType"),s=b("FragranceFamilyRefinement"),n=b("IngredientsPreferences"),d=b("shoppingPreference"),p=b("ConcernsRefinement"),l=b("hairType"),_=b("hairTexture"),u=b("brandID");if(c.length===0&&s.length===0&&n.length===0&&d.length===0&&p.length===0&&l.length===0&&_.length===0&&u.length===0){certona.recommendations=false}else{certona.recommendations=true;resx.rrqs="language="+o;certona.filter.storeid=i;certona.filter.SkinType=c;certona.filter.FragranceFamilyRefinement=s;certona.filter.IngredientsPreferences=n;certona.filter.shoppingPreference=d;certona.filter.ConcernsRefinement=p;certona.filter.hairType=l;certona.filter.hairTexture=_;certona.filter.brandID=u}break;case"savingsevent":break;case"addtocart":f({event:r.isCertonaProduct?"addtocart_opr":"addtocart_op",itemid:r.itemid||""});certona.recommendations=r.recommendations;break;case"ropisaddtocart":f({event:r.isCertonaProduct?"addtocart_opr":"addtocart_op",itemid:r.itemid||""});certona.recommendations=r.recommendations;certona.filter.storeid=r.storeid?r.storeid:"";break;case"productsimilar":f({event:"",itemid:b("itemid")});certona.recommendations=r.recommendations;break;case"productcleanhighlight":f({event:"",itemid:b("itemid")});certona.recommendations=r.recommendations;break;case"minicart":certona.recommendations=r.recommendations;break;case"cartremove":resx.customerid=r.customerId||"";f({event:"cartremove_op",itemid:r.itemid||""});certona.recommendations=false;break;case"quickview":f({event:r.isCertonaProduct?"quickview_opr":"quickview_op",itemid:r.itemid||""});certona.recommendations=false;break;case"wishlistadd":f({event:"wishlistadd_op",itemid:r.itemid||""});certona.recommendations=false;break;case"wishlistremove":f({event:"wishlistremove_op",itemid:r.itemid||""});certona.recommendations=false;break;case"login":resx.customerid=r.customerId||"";certona.recommendations=false;break;case"similar":case"similarproductselected":case"purchasehistory":resx.pageid=b("pageId");resx.itemid=r.itemid||"";resx.exitemid="SKU"+r.itemid+";"+resx.exitemid;break;case"compareproductselected":f({event:"",itemid:r.itemid||""});certona.recommendations=r.returnBasketRecs;break;default:break}g({pageType:a,isRec:b("recommendations")});m.run()}catch(r){}};function i(){if(r&&r.length){return r.indexOf(v(b("pagetype")))>=0}return false}function g(r){try{if(!r.isRec===true||!r.isRec==="true"){return}resx.rrec=!!r.isRec;resx.rrcall=b("callback")||"Sephora.certona";var e=v(b("device"))||"desktop";var t=v(b("country"));var a=r.pageType;resx.rrelem=o[e][t][a];if(i()){b("filter")&&n()}else{b("filter")&&s()}}catch(r){}}window.getCertonaRecs=function(r){try{certona.page=r;certona.pageId=resx.pageid;callCertona()}catch(r){}};function y(){try{var r,e,t,a,o,i;r=Math.floor(Math.random()*1e15)+"";e=new Date;t=e.getFullYear()+"";a=e.getMonth()+1+"";o=e.getDate()+"";i=e.getHours()+"";r="res"+t.substring(2)+c(a,2)+c(o,2)+c(i,2)+r;return r}catch(r){}return""}function c(r,e){try{var t=r+"";while(t.length<e){t="0"+t}return t}catch(r){}}function f(r){try{var e=RegExp(".*_op");var t=e.test(r.event);if(location.href.indexOf("rrec=true")>=0&&!t){resx.event=r.event+"_r"}else{resx.event=r.event}resx.itemid=r.itemid;resx.exitemid="SKU"+r.itemid+";"+resx.exitemid}catch(r){}}function s(){try{var a=certona.filter;var o="";Object.keys(a).forEach(function(r,e){var t=e!==0?"&":"";o+=t+r+"="+encodeURIComponent(a[r])});resx.rrqs=o}catch(r){}}function n(){try{var r=certona.filter;var t="";var a="";Object.keys(r).forEach(function(e){if(Array.isArray(r[e])||typeof r[e]==="string"){a=Array.isArray(r[e])?r[e]:r[e].split(";");a.forEach(function(r){try{if(r!==""){t+=e+"="+encodeURIComponent(r)+";"}}catch(r){}})}else{t+=e+"="+encodeURIComponent(r[e])+";"}});t=t.replace(/;$/g,"");resx.rrnav=t}catch(r){}}function b(r,e){try{var t=e!==undefined?e:"";if(typeof certona!=="undefined"&&Object.prototype.toString.call(certona)==="[object Object]"){return certona[r]||t}}catch(r){}}function v(r){try{return typeof r!==undefined&&Object.prototype.toString.call(r)==="[object String]"?r.toLowerCase():r}catch(r){}}})(certonaResx);
